View(pois_preds)
vroom_write(pois_preds, "pois_predictions.csv", ",")
bike_pois_workflow <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(pois_mod) %>%
fit(data = logBikeTrain)
pois_bike_preds <- predict(bike_pois_workflow, new_data = bikeTest)
preds_function <- function(bike_predictions) {
bike_predictions$.pred[is.na(bike_predictions$.pred)] <- 0
bike_predictions$.pred[bike_predictions$.pred < 0] <- 0
preds <- cbind(bikeTest$datetime, bike_predictions)
colnames(preds) <- c("datetime","count")
preds$datetime <- as.character(format(preds$datetime))
preds$count <- exp(preds$count)
return(preds)
}
pois_preds <- preds_function(pois_bike_preds)
View(pois_preds)
bike_recipe <- recipe(count~., data=bikeTrain) %>%
step_mutate(weather=ifelse(weather==4, 3, weather)) %>% #Relabel weather 4 to 3
step_mutate(weather=factor(weather, levels=1:3, labels=c("Sunny", "Mist", "Rain"))) %>%
step_mutate(season=factor(season, levels=1:4, labels=c("Spring", "Summer", "Fall", "Winter"))) %>%
step_mutate(holiday=factor(holiday, levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(workingday=factor(workingday,levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(weekend = ifelse((workingday == "No" & holiday == "No"), "Yes", "No"))
bike_recipe <- recipe(count~., data=bikeTrain) %>%
step_mutate(weather=ifelse(weather==4, 3, weather)) %>% #Relabel weather 4 to 3
step_mutate(weather=factor(weather, levels=1:3, labels=c("Sunny", "Mist", "Rain"))) %>%
step_mutate(season=factor(season, levels=1:4, labels=c("Spring", "Summer", "Fall", "Winter"))) %>%
step_mutate(holiday=factor(holiday, levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(workingday=factor(workingday,levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(weekend = ifelse((workingday == "No" & holiday == "No"), "Yes", "No")) %>%
step_time(datetime, features="hour") %>%
step_rm(datetime) %>%
step_dummy(all_nominal_predictors()) %>%
step_normalize(all_numeric_predictors())
pois_mod <- poisson_reg() %>%
set_engine("glm")
bike_pois_workflow <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(pois_mod) %>%
fit(data = logBikeTrain)
pois_bike_preds <- predict(bike_pois_workflow, new_data = bikeTest)
preds_function <- function(bike_predictions) {
bike_predictions$.pred[is.na(bike_predictions$.pred)] <- 0
bike_predictions$.pred[bike_predictions$.pred < 0] <- 0
preds <- cbind(bikeTest$datetime, bike_predictions)
colnames(preds) <- c("datetime","count")
preds$datetime <- as.character(format(preds$datetime))
preds$count <- exp(preds$count)
return(preds)
}
pois_bike_preds <- predict(bike_pois_workflow, new_data = bikeTest)
bike_pois_workflow <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(pois_mod) %>%
fit(data = bikeTrain)
bike_recipe <- recipe(count~., data=bikeTrain) %>%
step_mutate(weather=ifelse(weather==4, 3, weather)) %>% #Relabel weather 4 to 3
step_mutate(weather=factor(weather, levels=1:3, labels=c("Sunny", "Mist", "Rain"))) %>%
step_mutate(season=factor(season, levels=1:4, labels=c("Spring", "Summer", "Fall", "Winter"))) %>%
step_mutate(holiday=factor(holiday, levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(workingday=factor(workingday,levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(weekend = ifelse((workingday == "No" & holiday == "No"), "Yes", "No")) %>%
step_mutate(weekend=factor(weekend, levels = c(0,1), labels = c("No", "Yes"))) %>%
step_time(datetime, features="hour") %>%
step_rm(datetime) %>%
step_dummy(all_nominal_predictors()) %>%
step_normalize(all_numeric_predictors())
pois_mod <- poisson_reg() %>%
set_engine("glm")
bike_pois_workflow <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(pois_mod) %>%
fit(data = bikeTrain)
bike_recipe <- recipe(count~., data=bikeTrain) %>%
step_mutate(weather=ifelse(weather==4, 3, weather)) %>% #Relabel weather 4 to 3
step_mutate(weather=factor(weather, levels=1:3, labels=c("Sunny", "Mist", "Rain"))) %>%
step_mutate(season=factor(season, levels=1:4, labels=c("Spring", "Summer", "Fall", "Winter"))) %>%
step_mutate(holiday=factor(holiday, levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(workingday=factor(workingday,levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(weekend = ifelse((workingday == "No" & holiday == "No"), 1, 0)) %>%
step_mutate(weekend=factor(weekend, levels = c(0,1), labels = c("No", "Yes"))) %>%
step_time(datetime, features="hour") %>%
step_rm(datetime) %>%
step_dummy(all_nominal_predictors()) %>%
step_normalize(all_numeric_predictors())
pois_mod <- poisson_reg() %>%
set_engine("glm")
bike_pois_workflow <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(pois_mod) %>%
fit(data = bikeTrain)
pois_bike_preds <- predict(bike_pois_workflow, new_data = bikeTest)
bike_predictions$.pred[bike_predictions$.pred < 0] <- 0
preds_function <- function(bike_predictions) {
bike_predictions$.pred[is.na(bike_predictions$.pred)] <- 0
bike_predictions$.pred[bike_predictions$.pred < 0] <- 0
preds <- cbind(bikeTest$datetime, bike_predictions)
colnames(preds) <- c("datetime","count")
preds$datetime <- as.character(format(preds$datetime))
#preds$count <- exp(preds$count)
return(preds)
}
pois_preds <- preds_function(pois_bike_preds)
View(pois_preds)
vroom_write(pois_preds, "pois_predictions.csv", ",")
bikeTrain <- vroom("./train.csv")
bikeTest <- vroom("test.csv")
bikeTrain <- bikeTrain %>%
select(-casual, -registered)
bikeTrain$day <- wday(bikeTrain$datetime)
bikeTest$day <- wday(bikeTest$datetime)
bikeTrain <- vroom("./train.csv")
bikeTest <- vroom("test.csv")
bikeTrain <- bikeTrain %>%
select(-casual, -registered)
bike_recipe <- recipe(count~., data=bikeTrain) %>%
step_mutate(weather=ifelse(weather==4, 3, weather)) %>% #Relabel weather 4 to 3
step_mutate(weather=factor(weather, levels=1:3, labels=c("Sunny", "Mist", "Rain"))) %>%
step_mutate(season=factor(season, levels=1:4, labels=c("Spring", "Summer", "Fall", "Winter"))) %>%
step_mutate(holiday=factor(holiday, levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(workingday=factor(workingday,levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(weekend = ifelse((workingday == "No" & holiday == "No"), 1, 0)) %>%
step_mutate(weekend=factor(weekend, levels = c(0,1), labels = c("No", "Yes"))) %>%
step_time(datetime, features="hour") %>%
step_rm(datetime) %>%
step_dummy(all_nominal_predictors()) %>%
step_normalize(all_numeric_predictors())
pois_mod <- poisson_reg() %>%
set_engine("glm")
bike_pois_workflow <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(pois_mod) %>%
fit(data = bikeTrain)
pois_bike_preds <- predict(bike_pois_workflow, new_data = bikeTest)
preds_function <- function(bike_predictions) {
bike_predictions$.pred[is.na(bike_predictions$.pred)] <- 0
bike_predictions$.pred[bike_predictions$.pred < 0] <- 0
preds <- cbind(bikeTest$datetime, bike_predictions)
colnames(preds) <- c("datetime","count")
preds$datetime <- as.character(format(preds$datetime))
#preds$count <- exp(preds$count)
return(preds)
}
pois_preds <- preds_function(pois_bike_preds)
vroom_write(pois_preds, "pois_predictions.csv", ",")
View(pois_preds)
pois_mod <- poisson_reg() %>%
set_engine("glm")
bike_pois_workflow <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(pois_mod) %>%
fit(data = bikeTrain)
pois_bike_preds <- predict(bike_pois_workflow, new_data = bikeTest)
preg_model <- linear_reg(penalty = 4, mixture = .5) %>%
set_engine("glmnet")
preg_wf <- workflow() %>%
add_recipe(my_recipe) %>%
add_model(preg_model) %>%
fit(data = bikeTrain)
bike_predictions <- predict(preg_wf, new_data = bikeTest)
preg_wf <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(preg_model) %>%
fit(data = bikeTrain)
preg_bike_preds <- predict(preg_wf, new_data = bikeTest)
pois_preds <- preds_function(pois_bike_preds)
preg_preds <- preds_function(preg_bike_preds)
View(pois_preds)
View(preg_preds)
vroom_write(pois_preds, "pois_predictions.csv", ",")
vroom_write(preg_preds, "preg_predictions.csv", ",")
bike_recipe <- recipe(count~., data=bikeTrain) %>%
step_mutate(weather=ifelse(weather==4, 3, weather)) %>% #Relabel weather 4 to 3
step_mutate(weather=factor(weather, levels=1:3, labels=c("Sunny", "Mist", "Rain"))) %>%
step_mutate(season=factor(season, levels=1:4, labels=c("Spring", "Summer", "Fall", "Winter"))) %>%
step_mutate(holiday=factor(holiday, levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(workingday=factor(workingday,levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(weekend = ifelse((workingday == "No" & holiday == "No"), 1, 0)) %>%
step_mutate(weekend=factor(weekend, levels = c(0,1), labels = c("No", "Yes"))) %>%
step_time(datetime, features="hour") %>%
step_rm(datetime) %>%
step_rm(atemp) %>%
step_dummy(all_nominal_predictors()) %>%
step_normalize(all_numeric_predictors())
pois_mod <- poisson_reg() %>%
set_engine("glm")
bike_pois_workflow <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(pois_mod) %>%
fit(data = bikeTrain)
pois_bike_preds <- predict(bike_pois_workflow, new_data = bikeTest)
bike_recipe <- recipe(count~., data=bikeTrain) %>%
step_mutate(weather=ifelse(weather==4, 3, weather)) %>% #Relabel weather 4 to 3
step_mutate(weather=factor(weather, levels=1:3, labels=c("Sunny", "Mist", "Rain"))) %>%
step_mutate(season=factor(season, levels=1:4, labels=c("Spring", "Summer", "Fall", "Winter"))) %>%
step_mutate(holiday=factor(holiday, levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(workingday=factor(workingday,levels=c(0,1), labels=c("No", "Yes"))) %>%
#step_mutate(weekend = ifelse((workingday == "No" & holiday == "No"), 1, 0)) %>%
#step_mutate(weekend=factor(weekend, levels = c(0,1), labels = c("No", "Yes"))) %>%
step_time(datetime, features="hour") %>%
step_rm(datetime) %>%
step_rm(atemp) %>%
step_dummy(all_nominal_predictors()) %>%
step_normalize(all_numeric_predictors())
pois_mod <- poisson_reg() %>%
set_engine("glm")
bike_pois_workflow <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(pois_mod) %>%
fit(data = bikeTrain)
pois_bike_preds <- predict(bike_pois_workflow, new_data = bikeTest)
preg_model <- linear_reg(penalty = 4, mixture = .5) %>%
set_engine("glmnet")
preg_wf <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(preg_model) %>%
fit(data = bikeTrain)
preg_bike_preds <- predict(preg_wf, new_data = bikeTest)
preds_function <- function(bike_predictions) {
bike_predictions$.pred[is.na(bike_predictions$.pred)] <- 0
bike_predictions$.pred[bike_predictions$.pred < 0] <- 0
preds <- cbind(bikeTest$datetime, bike_predictions)
colnames(preds) <- c("datetime","count")
preds$datetime <- as.character(format(preds$datetime))
#preds$count <- exp(preds$count)
return(preds)
}
pois_preds <- preds_function(pois_bike_preds)
preg_preds <- preds_function(preg_bike_preds)
View(pois_preds)
View(preg_preds)
logBikeTrain <- bikeTrain %>%
mutate(count = log(count))
bike_recipe <- recipe(count~., data=bikeTrain) %>%
step_mutate(weather=ifelse(weather==4, 3, weather)) %>% #Relabel weather 4 to 3
step_mutate(weather=factor(weather, levels=1:3, labels=c("Sunny", "Mist", "Rain"))) %>%
step_mutate(season=factor(season, levels=1:4, labels=c("Spring", "Summer", "Fall", "Winter"))) %>%
step_mutate(holiday=factor(holiday, levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(workingday=factor(workingday,levels=c(0,1), labels=c("No", "Yes"))) %>%
#step_mutate(weekend = ifelse((workingday == "No" & holiday == "No"), 1, 0)) %>%
#step_mutate(weekend=factor(weekend, levels = c(0,1), labels = c("No", "Yes"))) %>%
step_time(datetime, features="hour") %>%
step_rm(datetime) %>%
step_rm(atemp) %>%
step_dummy(all_nominal_predictors()) %>%
step_normalize(all_numeric_predictors())
pois_mod <- poisson_reg() %>%
set_engine("glm")
bike_pois_workflow <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(pois_mod) %>%
fit(data = logBikeTrain)
warnings()
bike_pois_workflow <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(pois_mod) %>%
fit(data = bikeTrain)
bike_recipe <- recipe(count~., data=bikeTrain) %>%
step_mutate(weather=ifelse(weather==4, 3, weather)) %>% #Relabel weather 4 to 3
step_mutate(weather=factor(weather, levels=1:3, labels=c("Sunny", "Mist", "Rain"))) %>%
step_mutate(season=factor(season, levels=1:4, labels=c("Spring", "Summer", "Fall", "Winter"))) %>%
step_mutate(weekend = ifelse((workingday == 0 & holiday == 0), 1, 0)) %>%
step_mutate(holiday=factor(holiday, levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(workingday=factor(workingday,levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(weekend=factor(weekend, levels = c(0,1), labels = c("No", "Yes"))) %>%
step_time(datetime, features="hour") %>%
step_rm(datetime) %>%
step_rm(atemp) %>%
step_dummy(all_nominal_predictors()) %>%
step_normalize(all_numeric_predictors())
pois_mod <- poisson_reg() %>%
set_engine("glm")
bike_pois_workflow <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(pois_mod) %>%
fit(data = bikeTrain)
pois_bike_preds <- predict(bike_pois_workflow, new_data = bikeTest)
bike_recipe <- recipe(count~., data=bikeTrain) %>%
step_mutate(weather=ifelse(weather==4, 3, weather)) %>% #Relabel weather 4 to 3
step_mutate(weather=factor(weather, levels=1:3, labels=c("Sunny", "Mist", "Rain"))) %>%
step_mutate(season=factor(season, levels=1:4, labels=c("Spring", "Summer", "Fall", "Winter"))) %>%
step_mutate(weekend = ifelse((workingday == 0 & holiday == 0), 1, 0)) %>%
step_mutate(holiday=factor(holiday, levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(workingday=factor(workingday,levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(weekend=factor(weekend, levels = c(0,1), labels = c("No", "Yes"))) %>%
step_time(datetime, features="hour") %>%
step_rm(workingday) %>%
step_rm(datetime) %>%
step_rm(atemp) %>%
step_dummy(all_nominal_predictors()) %>%
step_normalize(all_numeric_predictors())
pois_mod <- poisson_reg() %>%
set_engine("glm")
bike_pois_workflow <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(pois_mod) %>%
fit(data = bikeTrain)
pois_bike_preds <- predict(bike_pois_workflow, new_data = bikeTest)
preds_function <- function(bike_predictions) {
bike_predictions$.pred[is.na(bike_predictions$.pred)] <- 0
bike_predictions$.pred[bike_predictions$.pred < 0] <- 0
preds <- cbind(bikeTest$datetime, bike_predictions)
colnames(preds) <- c("datetime","count")
preds$datetime <- as.character(format(preds$datetime))
#preds$count <- exp(preds$count)
return(preds)
}
pois_preds <- preds_function(pois_bike_preds)
preg_preds <- preds_function(preg_bike_preds)
preg_model <- linear_reg(penalty = 4, mixture = .5) %>%
set_engine("glmnet")
preg_wf <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(preg_model) %>%
fit(data = bikeTrain)
preg_bike_preds <- predict(preg_wf, new_data = bikeTest)
preds_function <- function(bike_predictions) {
bike_predictions$.pred[is.na(bike_predictions$.pred)] <- 0
bike_predictions$.pred[bike_predictions$.pred < 0] <- 0
preds <- cbind(bikeTest$datetime, bike_predictions)
colnames(preds) <- c("datetime","count")
preds$datetime <- as.character(format(preds$datetime))
#preds$count <- exp(preds$count)
return(preds)
}
pois_preds <- preds_function(pois_bike_preds)
preg_preds <- preds_function(preg_bike_preds)
vroom_write(pois_preds, "pois_predictions.csv", ",")
vroom_write(preg_preds, "preg_predictions.csv", ",")
preg_model <- poisson_reg(penalty = 4, mixture = .5) %>%
set_engine("glmnet")
preg_wf <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(preg_model) %>%
fit(data = bikeTrain)
preg_bike_preds <- predict(preg_wf, new_data = bikeTest)
preds_function <- function(bike_predictions) {
bike_predictions$.pred[is.na(bike_predictions$.pred)] <- 0
bike_predictions$.pred[bike_predictions$.pred < 0] <- 0
preds <- cbind(bikeTest$datetime, bike_predictions)
colnames(preds) <- c("datetime","count")
preds$datetime <- as.character(format(preds$datetime))
#preds$count <- exp(preds$count)
return(preds)
}
pois_preds <- preds_function(pois_bike_preds)
preg_preds <- preds_function(preg_bike_preds)
View(preg_preds)
preg_wf <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(preg_model) %>%
fit(data = logBikeTrain)
preg_bike_preds <- predict(preg_wf, new_data = bikeTest)
preds_function <- function(bike_predictions) {
bike_predictions$.pred[is.na(bike_predictions$.pred)] <- 0
bike_predictions$.pred[bike_predictions$.pred < 0] <- 0
preds <- cbind(bikeTest$datetime, bike_predictions)
colnames(preds) <- c("datetime","count")
preds$datetime <- as.character(format(preds$datetime))
preds$count <- exp(preds$count)
return(preds)
}
preg_preds <- preds_function(preg_bike_preds)
View(preg_preds)
vroom_write(preg_preds, "preg_predictions.csv", ",")
preg_model <- poisson_reg(penalty = 4, mixture = .5) %>%
set_engine("glm")
preg_wf <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(preg_model) %>%
fit(data = bikeTrain)
preg_bike_preds <- predict(preg_wf, new_data = bikeTest)
preds_function <- function(bike_predictions) {
bike_predictions$.pred[is.na(bike_predictions$.pred)] <- 0
bike_predictions$.pred[bike_predictions$.pred < 0] <- 0
preds <- cbind(bikeTest$datetime, bike_predictions)
colnames(preds) <- c("datetime","count")
preds$datetime <- as.character(format(preds$datetime))
#preds$count <- exp(preds$count)
return(preds)
}
preg_preds <- preds_function(preg_bike_preds)
View(preg_preds)
vroom_write(preg_preds, "preg_predictions.csv", ",")
preg_model <- poisson_reg(penalty = 1, mixture = .8) %>%
set_engine("glm")
preg_wf <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(preg_model) %>%
fit(data = bikeTrain)
preg_bike_preds <- predict(preg_wf, new_data = bikeTest)
preds_function <- function(bike_predictions) {
bike_predictions$.pred[is.na(bike_predictions$.pred)] <- 0
bike_predictions$.pred[bike_predictions$.pred < 0] <- 0
preds <- cbind(bikeTest$datetime, bike_predictions)
colnames(preds) <- c("datetime","count")
preds$datetime <- as.character(format(preds$datetime))
#preds$count <- exp(preds$count)
return(preds)
}
preg_preds <- preds_function(preg_bike_preds)
vroom_write(preg_preds, "preg_predictions.csv", ",")
View(preg_preds)
preg_model <- poisson_reg(penalty = 5, mixture = .8) %>%
set_engine("glm")
preg_wf <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(preg_model) %>%
fit(data = bikeTrain)
preg_bike_preds <- predict(preg_wf, new_data = bikeTest)
preds_function <- function(bike_predictions) {
bike_predictions$.pred[is.na(bike_predictions$.pred)] <- 0
bike_predictions$.pred[bike_predictions$.pred < 0] <- 0
preds <- cbind(bikeTest$datetime, bike_predictions)
colnames(preds) <- c("datetime","count")
preds$datetime <- as.character(format(preds$datetime))
#preds$count <- exp(preds$count)
return(preds)
}
preg_preds <- preds_function(preg_bike_preds)
View(preg_preds)
vroom_write(preg_preds, "preg_predictions.csv", ",")
bike_recipe <- recipe(count~., data=bikeTrain) %>%
step_mutate(weather=ifelse(weather==4, 3, weather)) %>% #Relabel weather 4 to 3
step_mutate(weather=factor(weather, levels=1:3, labels=c("Sunny", "Mist", "Rain"))) %>%
step_mutate(season=factor(season, levels=1:4, labels=c("Spring", "Summer", "Fall", "Winter"))) %>%
step_mutate(weekend = ifelse((workingday == 0 & holiday == 0), 1, 0)) %>%
step_mutate(holiday=factor(holiday, levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(workingday=factor(workingday,levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(weekend=factor(weekend, levels = c(0,1), labels = c("No", "Yes"))) %>%
step_time(datetime, features="hour") %>%
step_rm(workingday, datetime, atemp) %>%
step_dummy(all_nominal_predictors()) %>%
step_normalize(all_numeric_predictors())
pois_mod <- poisson_reg() %>%
set_engine("glm")
bike_pois_workflow <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(pois_mod) %>%
fit(data = bikeTrain)
bike_recipe <- recipe(count~., data=bikeTrain) %>%
step_mutate(weather=ifelse(weather==4, 3, weather)) %>% #Relabel weather 4 to 3
step_mutate(weather=factor(weather, levels=1:3, labels=c("Sunny", "Mist", "Rain"))) %>%
step_mutate(season=factor(season, levels=1:4, labels=c("Spring", "Summer", "Fall", "Winter"))) %>%
step_mutate(weekend = ifelse((workingday == 0 & holiday == 0), 1, 0)) %>%
step_mutate(holiday=factor(holiday, levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(workingday=factor(workingday,levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(weekend=factor(weekend, levels = c(0,1), labels = c("No", "Yes"))) %>%
step_time(datetime, features="hour") %>%
?step_date()
?step_date()
bike_recipe <- recipe(count~., data=bikeTrain) %>%
step_mutate(weather=ifelse(weather==4, 3, weather)) %>% #Relabel weather 4 to 3
step_mutate(weather=factor(weather, levels=1:3, labels=c("Sunny", "Mist", "Rain"))) %>%
step_mutate(season=factor(season, levels=1:4, labels=c("Spring", "Summer", "Fall", "Winter"))) %>%
step_mutate(weekend = ifelse((workingday == 0 & holiday == 0), 1, 0)) %>%
step_mutate(holiday=factor(holiday, levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(workingday=factor(workingday,levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(weekend=factor(weekend, levels = c(0,1), labels = c("No", "Yes"))) %>%
step_time(datetime, features="hour") %>%
step_date(datetime, features = c("dow", "month","year")) %>%
step_rm(workingday, datetime, atemp) %>%
step_dummy(all_nominal_predictors()) %>%
step_normalize(all_numeric_predictors())
pois_mod <- poisson_reg() %>%
set_engine("glm")
bike_pois_workflow <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(pois_mod) %>%
fit(data = bikeTrain)
pois_bike_preds <- predict(bike_pois_workflow, new_data = bikeTest)
bike_recipe <- recipe(count~., data=bikeTrain) %>%
step_mutate(weather=ifelse(weather==4, 3, weather)) %>% #Relabel weather 4 to 3
step_mutate(weather=factor(weather, levels=1:3, labels=c("Sunny", "Mist", "Rain"))) %>%
step_mutate(season=factor(season, levels=1:4, labels=c("Spring", "Summer", "Fall", "Winter"))) %>%
step_mutate(weekend = ifelse((workingday == 0 & holiday == 0), 1, 0)) %>%
step_mutate(holiday=factor(holiday, levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(workingday=factor(workingday,levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(weekend=factor(weekend, levels = c(0,1), labels = c("No", "Yes"))) %>%
step_time(datetime, features="hour") %>%
step_date(datetime, features = c("month","year")) %>%
step_rm(workingday, datetime, atemp) %>%
step_dummy(all_nominal_predictors()) %>%
step_normalize(all_numeric_predictors())
pois_mod <- poisson_reg() %>%
set_engine("glm")
bike_pois_workflow <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(pois_mod) %>%
fit(data = bikeTrain)
pois_bike_preds <- predict(bike_pois_workflow, new_data = bikeTest)
bike_recipe <- recipe(count~., data=bikeTrain) %>%
step_mutate(weather=ifelse(weather==4, 3, weather)) %>% #Relabel weather 4 to 3
step_mutate(weather=factor(weather, levels=1:3, labels=c("Sunny", "Mist", "Rain"))) %>%
step_mutate(season=factor(season, levels=1:4, labels=c("Spring", "Summer", "Fall", "Winter"))) %>%
step_mutate(weekend = ifelse((workingday == 0 & holiday == 0), 1, 0)) %>%
step_mutate(holiday=factor(holiday, levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(workingday=factor(workingday,levels=c(0,1), labels=c("No", "Yes"))) %>%
step_mutate(weekend=factor(weekend, levels = c(0,1), labels = c("No", "Yes"))) %>%
step_time(datetime, features="hour") %>%
step_rm(workingday, datetime, atemp) %>%
step_dummy(all_nominal_predictors()) %>%
step_normalize(all_numeric_predictors())
pois_mod <- poisson_reg() %>%
set_engine("glm")
bike_pois_workflow <- workflow() %>%
add_recipe(bike_recipe) %>%
add_model(pois_mod) %>%
fit(data = bikeTrain)
pois_bike_preds <- predict(bike_pois_workflow, new_data = bikeTest)
